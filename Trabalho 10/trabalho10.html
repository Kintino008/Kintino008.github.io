<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversor de Temperaturas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            transition: background-color 0.5s ease;
            text-align: center;
            margin-top: 50px;
        }

        table {
            margin: 0 auto;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
        }

        td {
            padding: 10px;
        }

        input, select, button {
            padding: 8px;
            font-size: 1rem;
            width: 100%;
        }

        button {
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }

        button:hover {
            background-color: #0056b3;
        }

        #resultado {
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 20px;
        }

        footer {
            margin-top: 30px;
            font-size: 0.9em;
        }

        a {
            color: darkblue;
        }
    </style>
</head>
<body>

    <h1>üå°Ô∏è Conversor de Temperaturas</h1>

    <form id="formConversor" onsubmit="event.preventDefault(); converter();">
        <table border="1">
            <tr>
                <td><label for="valor">Valor:</label></td>
                <td><input type="number" id="valor" name="valor" step="any" required oninput="validarInput()"></td>
            </tr>
            <tr>
                <td><label for="de">De:</label></td>
                <td>
                    <select id="de" onchange="atualizarRestricoes(); validarInput()">
                        <option value="C">Celsius (¬∞C)</option>
                        <option value="F">Fahrenheit (¬∞F)</option>
                        <option value="K">Kelvin (K)</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label for="para">Para:</label></td>
                <td>
                    <select id="para">
                        <option value="C">Celsius (¬∞C)</option>
                        <option value="F">Fahrenheit (¬∞F)</option>
                        <option value="K">Kelvin (K)</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td colspan="2"><button type="submit">Converter</button></td>
            </tr>
        </table>
    </form>

    <div id="resultado"></div>

    <button onclick="inserirPorPrompt()">Inserir valor via Prompt</button>

    <footer>
        <p>F√≥rmulas baseadas em <a href="https://www.britannica.com/science/temperature" target="_blank">Encyclopaedia Britannica</a></p>
    </footer>

    <script>
        // Atualiza restri√ß√µes do input dependendo da escala
        function atualizarRestricoes() {
            const valor = document.getElementById("valor");
            const escala = document.getElementById("de").value;

            if (escala === "K") {
                valor.min = 0;
            } else {
                valor.removeAttribute("min");
            }
        }

        // Valida√ß√£o do input
        function validarInput() {
            const valor = document.getElementById("valor");
            const escalaDe = document.getElementById("de").value;

            if (escalaDe === "C" && valor.value < -273.15) {
                valor.setCustomValidity("A temperatura em Celsius n√£o pode ser inferior a -273.15 ¬∞C (zero absoluto).");
            } else if (escalaDe === "K" && valor.value < 0) {
                valor.setCustomValidity("A temperatura em Kelvin n√£o pode ser negativa (0 K √© o zero absoluto).");
            } else {
                valor.setCustomValidity("");
            }
        }

        // Fun√ß√£o de arredondamento
        function arredondar(num) {
            return Math.round(num * 100) / 100;
        }

        // Fun√ß√£o principal de convers√£o
        function converter() {
            const valor = parseFloat(document.getElementById("valor").value);
            const de = document.getElementById("de").value;
            const para = document.getElementById("para").value;

            if (isNaN(valor)) {
                alert("Por favor, insere um n√∫mero v√°lido.");
                return;
            }

            // Verifica√ß√£o de limites f√≠sicos
            if ((de === "C" && valor < -273.15) || (de === "K" && valor < 0)) {
                alert("Valor inv√°lido: a temperatura est√° abaixo do zero absoluto.");
                return;
            }

            let resultado;

            // Convers√µes entre escalas
            if (de === para) {
                resultado = valor;
            } else if (de === "C" && para === "F") {
                resultado = valor * 9/5 + 32;
            } else if (de === "F" && para === "C") {
                resultado = (valor - 32) * 5/9;
            } else if (de === "C" && para === "K") {
                resultado = valor + 273.15;
            } else if (de === "K" && para === "C") {
                resultado = valor - 273.15;
            } else if (de === "F" && para === "K") {
                resultado = (valor - 32) * 5/9 + 273.15;
            } else if (de === "K" && para === "F") {
                resultado = (valor - 273.15) * 9/5 + 32;
            }

            resultado = arredondar(resultado);

            // Impedir resultados Kelvin negativos
            if (para === "K" && resultado < 0) {
                alert("Erro: o resultado em Kelvin seria negativo, o que √© fisicamente imposs√≠vel.");
                return;
            }

            // Mostrar resultado
            document.getElementById("resultado").innerText =
                `${valor} ¬∞${de} = ${resultado} ¬∞${para}`;

            mudarFundo(resultado, para);
        }

        // Muda cor de fundo conforme a temperatura (em ¬∞C)
        function mudarFundo(valor, escala) {
            let tempC;

            if (escala === "C") tempC = valor;
            else if (escala === "F") tempC = (valor - 32) * 5/9;
            else if (escala === "K") tempC = valor - 273.15;

            if (tempC < 10) document.body.style.backgroundColor = "#66ccff"; // frio
            else if (tempC >= 10 && tempC <= 25) document.body.style.backgroundColor = "#ffcc00"; // ameno
            else document.body.style.backgroundColor = "#ff6666"; // quente
        }

        // Inserir valor via prompt()
        function inserirPorPrompt() {
            const valor = prompt("Insere um valor num√©rico para converter:");
            if (valor !== null && !isNaN(valor)) {
                document.getElementById("valor").value = valor;
                validarInput();
            } else {
                alert("Entrada inv√°lida. Por favor, insere um n√∫mero.");
            }
        }
    </script>
</body>
</html>
